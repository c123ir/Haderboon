بسیار عالی! با کمال میل. این فایل توضیحات، خلاصه‌ای از وضعیت فعلی پروژه "ایجنت هادربون" و برنامه‌ریزی ما برای شروع پیاده‌سازی ماژول احراز هویت را ارائه می‌دهد. این سند می‌تواند به عنوان یک مرجع در چت جدید مورد استفاده قرار گیرد.

---

## سند راهنمای چت جدید: پیاده‌سازی ماژول احراز هویت (Authentication)

### ۱. مقدمه پروژه "ایجنت هادربون"

**نام پروژه:** ایجنت هادربون (Haderboon)
**هدف کلی:** توسعه یک دستیار هوشمند مبتنی بر هوش مصنوعی برای مستندسازی، مشاوره و مدیریت پروژه‌های برنامه‌نویسی، با هدف حل مشکلات رایج در مستندسازی و حفظ همگام‌سازی بین کد و مستندات.

### ۲. وضعیت فعلی پروژه

*   **ساختار پروژه:**
    *   `Haderboon/`
        *   `Docs/` (شامل مستندات پروژه هادربون)
        *   `backend/` (کدهای سمت سرور)
        *   `frontend/` (کدهای سمت کاربر)
*   **تکنولوژی‌های انتخابی:**
    *   **بک‌اند (Backend):** Node.js, Express.js, TypeScript, Prisma ORM
    *   **فرانت‌اند (Frontend):** React 18.2, TypeScript, Tailwind CSS
    *   **پایگاه داده (Database):** PostgreSQL
*   **پورت‌های استفاده شده:**
    *   **بک‌اند:** `5550`
    *   **فرانت‌اند:** `3550`
*   **پایگاه داده PostgreSQL:**
    *   **نام دیتابیس:** `haderboon_db`
    *   **نام کاربری دیتابیس:** `haderboon_user`
    *   **پسورد دیتابیس:** `2123`
*   **وضعیت راه‌اندازی فعلی:**
    *   ساختار پوشه‌ای `backend` و `frontend` ایجاد شده‌اند.
    *   پروژه‌های Node.js و React در دایرکتوری‌های مربوطه راه‌اندازی شده‌اند.
    *   `tsconfig.json`, `package.json`, `.env` برای هر دو بخش پیکربندی شده‌اند.
    *   PostgreSQL نصب شده و دیتابیس `haderboon_db` و کاربر `haderboon_user` با دسترسی‌های لازم ایجاد شده‌اند.
    *   Prisma در بک‌اند مقداردهی اولیه شده، مدل `User` در `schema.prisma` تعریف شده و `npx prisma migrate dev` با موفقیت اجرا شده است (جدول `User` در دیتابیس ایجاد شده است).
    *   سرور بک‌اند (`npm run dev` در `backend/`) و سرور توسعه فرانت‌اند (`npm start` در `frontend/`) بدون خطا در حال اجرا هستند.
    *   فونت فارسی `Vazirmatn` در فرانت‌اند پیکربندی شده است.

### ۳. هدف در چت جدید: پیاده‌سازی ماژول احراز هویت (Authentication)

گام منطقی بعدی، پیاده‌سازی کامل سیستم احراز هویت است که به کاربران امکان ثبت نام و ورود به "ایجنت هادربون" را می‌دهد. این ماژول شامل بخش‌های بک‌اند و فرانت‌اند خواهد بود.

#### ۳.۱. مراحل پیاده‌سازی در بک‌اند (Backend)

1.  **مدل `User` (آماده):** مدل پایه `User` در `backend/prisma/schema.prisma` از قبل تعریف شده است.
2.  **نصب وابستگی‌های لازم:** `bcryptjs` (برای هش کردن پسورد) و `jsonwebtoken` (برای تولید JWT).
3.  **ایجاد کنترلر احراز هویت (`backend/src/controllers/authController.ts`):**
    *   تابع `registerUser`: دریافت اطلاعات کاربر، هش کردن پسورد، ذخیره در دیتابیس، تولید JWT و ارسال پاسخ.
    *   تابع `loginUser`: دریافت اطلاعات ورود، اعتبارسنجی پسورد، تولید JWT و ارسال پاسخ.
4.  **ایجاد مسیرهای احراز هویت (`backend/src/routes/authRoutes.ts`):**
    *   مسیر `POST /api/v1/auth/register` برای ثبت نام.
    *   مسیر `POST /api/v1/auth/login` برای ورود.
5.  **پیاده‌سازی Middleware احراز هویت (`backend/src/middleware/authMiddleware.ts`):**
    *   بررسی و اعتبار سنجی JWT از هدر درخواست.
    *   استخراج `userId` و قرار دادن آن در شیء `req.user` برای استفاده در کنترلرهای محافظت شده.

#### ۳.۲. مراحل پیاده‌سازی در فرانت‌اند (Frontend)

1.  **ایجاد سرویس API برای احراز هویت (`frontend/src/services/authService.ts`):**
    *   توابع برای ارسال درخواست‌های ثبت نام و ورود به APIهای بک‌اند.
    *   مدیریت ذخیره/حذف JWT در Local Storage.
2.  **ایجاد صفحات رابط کاربری:**
    *   **`frontend/src/pages/auth/Register.tsx`:** فرم ثبت نام کاربر.
    *   **`frontend/src/pages/auth/Login.tsx`:** فرم ورود کاربر.
3.  **مدیریت وضعیت احراز هویت:**
    *   استفاده از یک Context API یا کتابخانه‌ای مانند Zustand/Jotai برای مدیریت وضعیت ورود/خروج کاربر و نگهداری اطلاعات کاربر فعلی.
4.  **پیکربندی مسیریابی محافظت شده (`frontend/src/App.tsx`):**
    *   استفاده از یک کامپوننت `ProtectedRoute` برای اطمینان از اینکه فقط کاربران احراز هویت شده به صفحات خاص (مانند داشبورد) دسترسی دارند.

### ۴. نحوه ادامه کار در چت جدید

در چت جدید، ما ابتدا بر روی **پیاده‌سازی بخش بک‌اند ماژول احراز هویت** تمرکز خواهیم کرد. من گام به گام شما را راهنمایی خواهم کرد و کدهای لازم را ارائه خواهم داد. پس از تکمیل بخش بک‌اند، به سراغ پیاده‌سازی رابط کاربری فرانت‌اند خواهیم رفت.

**نکته مهم:** همیشه هر تغییری را در فایل‌های پروژه خود اعمال کنید و سپس در صورت نیاز، دستورات را در ترمینال اجرا کنید.

---

آماده برای شروع پیاده‌سازی ماژول احراز هویت هستیم!